# 右下角弹出菜单

基于现代 `tray-icon` 库创建的右下角系统托盘弹出菜单组件，已集成到 wei 主程序中。

## 功能特性

- 🎯 右下角系统托盘图标
- 📋 预设实用菜单项
- 🔧 跨平台支持 (Windows/macOS/Linux)
- 🎨 分隔符和图标支持
- 🖱️ 右键弹出菜单
- ⚡ 现代化实现

## 菜单项说明

- **显示界面** - 在浏览器中打开 Wei 管理界面 (http://127.0.0.1:1115)
- **文件管理** - 打开系统文件管理器
- **系统信息** - 显示操作系统和架构信息 (Windows 下显示通知)
- **网络状态** - 检查网络连接状态
- **设置** - 打开设置界面
- **帮助** - 打开项目帮助页面
- **退出** - 安全退出 Wei 系统

## 集成方式

托盘菜单已集成到 `main.rs` 中，在 Windows 系统下会自动启动：

```rust
#[cfg(target_os = "windows")] {
    info!("启动托盘菜单");
    tokio::task::spawn_blocking(|| {
        if let Err(e) = popup_menu::create_default_tray_menu() {
            eprintln!("托盘菜单启动失败: {}", e);
        }
    });
}
```

## 技术实现

- **库选择**: 使用 `tray-icon 0.21.1` 替代旧的 `systray`
- **事件处理**: 异步事件循环处理菜单点击
- **图标**: 自动生成渐变默认图标
- **跨平台**: 针对不同操作系统的文件管理器调用

## 依赖要求

```toml
[dependencies]
tray-icon = "0.21.1"
webbrowser = "0.8.12"
```

## 运行

```bash
# 编译并运行 wei 主程序，托盘菜单会自动启动
cargo run
```

## 平台支持

- **Windows**: 完全支持，包括通知功能
- **macOS**: 支持基础托盘功能
- **Linux**: 需要 GTK 环境，支持基础托盘功能

## 注意事项

1. 托盘菜单运行在后台线程中，不会阻塞主程序
2. Windows 下集成了系统通知功能
3. 菜单事件循环会监听用户点击并执行相应操作
4. 退出菜单项会调用 `wei_env::stop()` 安全关闭系统